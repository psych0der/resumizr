<!DOCTYPE html>
<html lang="en" ng-app>
	<head>
		<meta charset="utf-8">
		<title>Resumizr</title>
		{% load staticfiles %}
		
		<!-- google fonts -->
		<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="{% static 'resumizr/css/bootstrap.min.css' %}">
		<script src="{% static 'resumizr/js/angular.min.js' %}"></script>
		<script src="{% static 'resumizr/js/jquery.min.js' %}"></script>
		<script src="{% static 'resumizr/js/jquery-ui.min.js' %}"></script>
		<script src="{% static 'resumizr/js/bootstrap.min.js' %}"></script>
		<script src="{% static 'resumizr/js/ajax-load.js' %}"></script>
		<link href="{% static  'resumizr/css/font-awesome.min.css' %}" rel="stylesheet">
		<link href="{% static  'resumizr/css/resume-form.css' %}" rel="stylesheet">


		
	</head>
	<body>
<!-- ajax progress bar -->
<div class="progress-bar"></div>
<button class="refresh" id="refresh">Refresh Genius</button> 

	<div class="container"> 

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control prompt-section-title" placeholder="Change Section's Title"/>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary save-section-title">Save changes</button>
      </div>
    </div>
  </div>
</div>

<!-- Preview Modal -->
<div class="modal fade" id="myModalPreview" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">CV Preview</h4>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control prompt-section-title" placeholder="Change Section's Title"/>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary save-section-title">Save changes</button>
      </div>
    </div>
  </div>
</div>


		<div class="row">
		  <div class="col-md-3">
		  	<ul id="sortable">
		  	  <section class="card"><li class="uis" href="#1" data-toggle="tab"><i style="color:gray" class="fa fa-user"></i> Basic Information</li></section>
			   <section class="card"><li class="uis" href="#2" data-toggle="tab"><i style="color:gray" class="fa fa-suitcase"></i> Work Experience</li></section>
			   <section class="card"><li class="uis" href="#3" data-toggle="tab"><i style="color:gray" class="fa fa-book"></i> Education</li></section>
			   <section class="card"><li class="uis" href="#4" data-toggle="tab"><i style="color:gray" class="fa fa-certificate"></i> Achievements</li></section>
			</ul>
			<button class="btn btn-info add--section">Create a new Section</button>
		  </div>

		  <div class="col-md-9" style="width:70%;height:500px; margin-left:20px;overflow:auto">

		  	<div class="tab-content">
				<div class="tab-pane active" id="1">
				<div class="tab-header">
					<label class="label--text heading">Basic information</label>
				</div>
					<span style="margin-left: 20px; color:#9accea">
						<!-- temporarily disabled
						<a href=""><i class="fa fa-pencil" data-toggle="modal" data-target="#myModal" title="Edit"></i>&nbsp;</a>
						<a href=""><i class="fa fa-text-height" data-toggle="modal" data-target="#myModal" title="Font-size"></i>&nbsp;</a>
						<a href=""><i class="fa fa-font" type="color" title="Color"></i></a>
						<input type="color" class="fontSel" />
						-->
					</span>
					
					<div class="row">
						
						<div class="col-md-6">
						<div class="card">
							<label class="label--text sub-heading">Full Name</label>

						    <input type="text" class="form-control mod-text-box" placeholder="Eg: Varun Malhotra"/>   
						</div>
						</div>
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">Email Address</label>
							<input type="email" class="form-control mod-text-box" placeholder="Eg: valid.mail@gmail.com"/>
							</div>

						    <input type="text" class="form-control" data-field-value="1" placeholder="Eg: Varun Malhotra"/>
						</div>
						<div class="col-md-6">
							<label class="label--text sub-heading">Address</label>
							<input type="text" class="form-control" placeholder="Eg: A-1, Park Street, India"/>

						</div>
					
					</div>
					<br/>
					<div class="row">
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">Phone Number</label>
						    <input type="text" class="form-control mod-text-box" placeholder="Eg: (+91) 99XXXXXX89"/>
						    </div>
						</div>
						<div class="col-md-6">

							<div class="card">
							<label class="label--text sub-heading">Website</label>
							<input type="email" class="form-control mod-text-box" placeholder="Eg: http://yourname.info"/>
							</div>

					
						</div>
					</div>
					<br />
				</div>
				<div class="tab-pane" id="2">
					<label class="label--text heading">Work Experience</label>
					<span style="margin-left: 20px; color:#9accea">
						<!-- temporarily disabled
						<a href=""><i class="fa fa-pencil" data-toggle="modal" data-target="#myModal" title="Edit"></i>&nbsp;</a>
						<a href=""><i class="fa fa-text-height" title="Font-size"></i>&nbsp;</a>
						<a href=""><i class="fa fa-font" title="Color"></i></a>
						<input type="color" class="fontSel" />
						<a href=""><i style="color:#ed7b7b;float:right" class="fa fa-times fa-2x" title="Delete"></i></a>
						-->
					</span>
					<hr/>
					<div class="row">
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">Job Title</label>
						    <input type="text" class="form-control mod-text-box" placeholder="Eg: Frontend Designer"/>
							</div>
						</div>
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">Comapny Name</label>
							<input type="email" class="form-control mod-text-box" placeholder="Eg: Resumizr"/>
							</div>
						</div>
					</div>
					<br/>
					<div class="row">
						<div class="col-md-6">
						<div class="card">
							<label class="label--text sub-heading">Start Date</label>
						    <input type="text" class="form-control mod-text-box" placeholder="Eg: 14th May, 20xx"/>
						</div>
						</div>
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">End date</label>
							<input type="email" class="form-control mod-text-box" placeholder="Eg: 2nd July, 20xx"/>
							</div>
						</div>
					</div>
					<br/>
					<div class="row">
						<div class="col-md-12">
							<label class="label--text sub-heading">Description</label>
							<textarea class="form-control" rows="2"></textarea>
						</div>
					</div>
					<br/>
					<button class="btn btn-primary add-new-job">Add Entry</button>
				</div>
				<div class="tab-pane" id="3">
					<label class="label--text heading">Education</label>
					<span style="margin-left: 20px; color:#9accea">
						<!-- temporarily disabled
						<a href=""><i class="fa fa-pencil" data-toggle="modal" data-target="#myModal" title="Edit"></i>&nbsp;</a>
						<a href=""><i class="fa fa-text-height" title="Font-size"></i>&nbsp;</a>
						<a href=""><i class="fa fa-font" title="Color"></i></a>
						<input type="color" class="fontSel" />
						<a href=""><i style="color:#ed7b7b;float:right" class="fa fa-times fa-2x" title="Delete"></i></a>
						-->
					</span>
					<hr/>
					<div class="row">
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">Course Name</label>
						    <input type="text" class="form-control mod-text-box" placeholder="Eg: B.Tech"/>
						    </div>
						    
						</div>
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">Institution Name</label>
							<input type="email" class="form-control mod-text-box" placeholder="Eg: JIIT"/>
							</div>
						</div>
					</div>
					<br/>
					<div class="row">
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">Start Date</label>
						    <input type="text" class="form-control mod-text-box" placeholder="Eg: 14th June, 20xx"/>
						    </div>
						</div>
						<div class="col-md-6">
							<div class="card">
							<label class="label--text sub-heading">End date</label>
							<input type="email" class="form-control mod-text-box" placeholder="Eg: 2nd may, 20xx"/>
							</div>
						</div>
					</div>
					<br/>
					<div class="row">
						<div class="col-md-12">
							<label class="label--text sub-heading">Description</label>
							<textarea class="form-control" rows="2"></textarea>
						</div>
					</div>
					<br/>
					<button class="btn btn-primary add-new-education">Add Entry</button>
				</div>
				<div class="tab-pane" id="4">
					<label class="label--text heading">Achievements</label>
					<span style="margin-left: 20px; color:#9accea">
						<!-- temporarily disabled
						<a href=""><i class="fa fa-pencil" data-toggle="modal" data-target="#myModal" title="Edit"></i>&nbsp;</a>
						<a href=""><i class="fa fa-text-height" title="Font-size"></i>&nbsp;</a>
						<a href=""><i class="fa fa-font" title="Color"></i></a>
						<input type="color" class="fontSel" />
						<a href=""><i style="color:#ed7b7b;float:right" class="fa fa-times fa-2x" title="Delete"></i></a>
						-->
					</span>
					<hr/>
				</div>
	        </div>
		  </div>
		</div>


		
			<button type="submit" id="lol" class="btn">Preview</button>
		</form>
		<button id="lol" class="btn btn-success save--form">Save Form</button>
      </div>
		<!--
		<div class="tabbable tabs-left">
        <ul class="nav nav-tabs">
          <li class="active"><a href="#a" data-toggle="tab">Basic Information</a></li>
          <li><a href="#b" data-toggle="tab">Work Experience</a></li>
          <li><a href="#c" data-toggle="tab">Education</a></li>
          <li><a href="#d" data-toggle="tab">Achievements</a></li>
        </ul>
        <div class="tab-content">
         <div class="tab-pane active" id="a">...</div>
         <div class="tab-pane" id="b">...</div>
         <div class="tab-pane" id="c">...</div>
         <div class="tab-pane" id="d">...</div>
        </div>
      </div>
      -->
		<br/ >
		<h2>Start Creating Now</h2>
		
		<br />
			<div class="ui fluid form segment" ng-controller="SubmitFormField">
			<form class="form-horizontal" id="createForm" action = "/generate/cvform/" ng-submit="checkField()" method="post">
			{% csrf_token %}
			<br />
				  <div class="form-group">
				    <label for="heading" class="col-sm-1 control-label">Heading</label>
				    <div class="col-sm-10">
				    	<input type="text" class="form-control" name="heading" placeholder="Enter Heading">
				    </div>
				  </div>
				  <div class="form-group">
				    <label for="content" class="col-sm-1 control-label">Content</label>
				    <div class="col-sm-10">
				    	<textarea class="form-control" name="content" placeholder="Enter Content"></textarea>
				    </div>
				  </div>
		
			  <input type="submit" value="Submit" class="btn btn-success submit-form" />
		</form>
			</div>
			
		{{headingStatus}}
		{{contentStatus}}
		<!--<textarea name="content" id="markdown-editor" data-provide="markdown" data-iconlibrary="fa" data-savable="true" rows="10"></textarea>
		<textarea class="ckeditor" name="editor1"></textarea>
		</div>
		<script src="{% static 'js/markdown.js' %}"></script>
		<script src="{% static 'js/to-markdown.js' %}"></script>
		<script src="{% static 'js/bootstrap-markdown.js' %}"></script> -->
		<!-- <script src="{% static 'js/ckeditor.js' %}"></script>
		 -->
		<script type="text/javascript">
			function SubmitFormField($scope, $element) {
		  var loginForm = $($element);
		  //console.log(loginForm);
		  $scope.isInvalid = function() {
		    return !loginForm.form('validate form');
		  };

		  $scope.checkField = function () {
		    if (this.isInvalid()) {
		      return false;
		    }

		    alert("Register was clicked!");
		    return true;
		  };
		}
		</script>
		<script type="text/javascript">
			$(function () {
				
				/*
				$('#markdown-editor').markdown({
				  savable:true,
				  autofocus:true,
				  onShow: function(e){
				    alert("Showing "
				      +e.$textarea.prop("tagName").toLowerCase()
				      +"#"
				      +e.$textarea.attr("id")
				      +" as Markdown Editor...")
				  },
				  onPreview: function(e) {
				    var previewContent

				    if (e.isDirty()) {
				      var originalContent = e.getContent()

				      previewContent = "Prepended text here..."
				             + "\n"
				             + originalContent
				             + "\n"
				             +"Apended text here..."
				    } else {
				      previewContent = "Default content"
				    }

				    return previewContent
				  },
				  onSave: function(e) {
				    alert("Saving '"+e.getContent()+"'...")
				  },
				  onFocus: function(e) {
				    alert("Focus triggered!")
				  },
				  onBlur: function(e) {
				    alert("Blur triggered!")
				  }
				});
				*/
				var globalSectionId = 5;
				$( "#sortable" ).sortable({
			      placeholder: "ui-state-highlight"
			    });
			    $( "#sortable" ).disableSelection();
			    
			    $('#lol').click(function () {
			    	var formClientData = {};

			    	$('.uis').each(function () {
			    		var data='', id = $(this).attr('href'),
			    			emptySection = true,
			    			heading = $(id).find('.label--text.heading').text();
			    		$(id).find('.form-control').each(function () {
			    			if($(this).val()!=null && $(this).val()!=''){
					        	if (data=='')
					        		data = $(this).val();
					        	else
						        	data = data + '|&|' + $(this).val();
			    				emptySection = false; 
			    			}  
					    });
					    if(!emptySection){
					    	formClientData[heading] = data;
					    }
			    	});
			    	console.log(formClientData);
			    	buildoPreviewCv(formClientData);

			    });

			    $('.save--form').click(function () {
			    	var jsonFormData = buildoPreviewCv();
			    	// save to DB
			    	$.ajax({
					  url: "api.bhola.db",
					  context: document.body
					}).done(function() {
					  $( this ).addClass( "done" );
					});
			    });
			    
			    $('.add-new-job').click(function () {
			    	var newJobSection = '\
			    	<hr>\
			    	<div class="row">\
						<div class="col-md-6">\
							<label class="label--text sub-heading">Job Title</label>\
						    <input type="text" class="form-control" placeholder="Eg: Frontend Designer"/>\
						</div>\
						<div class="col-md-6">\
							<label class="label--text sub-heading">Comapny Name</label>\
							<input type="email" class="form-control" placeholder="Eg: Resumizr"/>\
						</div>\
					</div>\
					<br/>\
					<div class="row">\
						<div class="col-md-6">\
							<label class="label--text sub-heading">Start Date</label>\
						    <input type="text" class="form-control" placeholder="Eg: 14th May, 20xx"/>\
						</div>\
						<div class="col-md-6">\
							<label class="label--text sub-heading">End date</label>\
							<input type="email" class="form-control" placeholder="Eg: 2nd July, 20xx"/>\
						</div>\
					</div>\
					<br/>\
					<div class="row">\
						<div class="col-md-12">\
							<label class="label--text sub-heading">Description</label>\
							<textarea class="form-control" rows="2"></textarea>\
						</div>\
					</div>\
					<br />';
					$('.add-new-job').before(newJobSection);
			    });

				$('.add-new-education').click(function () {
					var newEduSection = '\
					<hr>\
					<div class="row">\
						<div class="col-md-6">\
							<label class="label--text sub-heading">Course Name</label>\
						    <input type="text" class="form-control" placeholder="Eg: B.Tech"/>\
						</div>\
						<div class="col-md-6">\
							<label class="label--text submit-form-heading">Institution Name</label>\
							<input type="email" class="form-control" placeholder="Eg: JIIT"/>\
						</div>\
					</div>\
					<br/>\
					<div class="row">\
						<div class="col-md-6">\
							<label class="label--text sub-heading">Start Date</label>\
						    <input type="text" class="form-control" placeholder="Eg: 14th June, 20xx"/>\
						</div>\
						<div class="col-md-6">\
							<label class="label--text sub-heading">End date</label>\
							<input type="email" class="form-control" placeholder="Eg: 2nd may, 20xx"/>\
						</div>\
					</div>\
					<div class="row">\
						<div class="col-md-12">\
							<label class="label--text sub-heading">Description</label>\
							<textarea class="form-control" rows="2"></textarea>\
						</div>\
					</div>\
					<br />';
					$('.add-new-education').before(newEduSection);
				});

			    $(document).on('click', '.save-section-title' ,function () {
			    	console.log($('.tab-pane.active').attr('id'));
			    	var text = $('.prompt-section-title').val();
			    	$('.tab-pane.active .label--text.heading').text(text);
			    	// change sortable li's
			    	text = '<i style="color:#777" class="fa fa-arrows-v"></i>  ' + text;
			    	$('#sortable li[href="#'+$('.tab-pane.active').attr('id')+'"').html(text);
			    });
			    $(document).on('click', '.save-font-size' ,function () {
			    	var text = $('.prompt-section-title').val() + 'px';
			    	$('.tab-pane.active .label--text.heading').css({'font-size':text});
			    });

			    $(document).on('click', '.fa.fa-pencil' ,function () {
			    	$('.modal-footer button:nth-child(2)').attr('class', 'btn btn-primary save-section-title');
			    });

			    $(document).on('click', '.fa.fa-text-height' ,function () {
			    	$('.modal-footer button:nth-child(2)').attr('class', 'btn btn-primary save-font-size');
			    });
			    $(document).on('click', '.fa.fa-font' ,function () {
			    	console.log($('#fontSel').click());
			    });
			    $(document).on('change', '.fontSel', function(){
			    	console.log('c');
				  	$('.tab-pane.active .label--text.heading').css({'color':$(this).val()});
				});
			    $(document).on('click', '.fa.fa-times' ,function () {
			    	var id = $('.tab-pane.active').attr('id');
			    	$('#sortable li[href="#'+id+'"').remove();
			    	$('#'+ $('.tab-pane.active').attr('id')).remove();
			    	if($('#sortable li[href="#'+id+'"').prev()) {
				    	$('#sortable li[href="#'+id+'"').prev().click();
				    }
				    else
				    	$('#sortable li[href="#1"]').click();
			    });


				var newEntry = '<div class="">'
					+
      			'<i style="color:red;" class="glyphicon glyphicon-minus-sign"></i>'
      				+
			  '<div class="form-group">'+
				    '<label for="heading" class="col-sm-1 control-label">Heading</label>'+
				    ' <div class="col-sm-10">' +
				    	'<input type="text" class="form-control" name="heading" placeholder="Enter Heading">'+
				    '</div>'+
				  '</div>'+
				  '<div class="form-group">'+
				    '<label for="content" class="col-sm-1 control-label">Content</label>'+
				    ' <div class="col-sm-10">'+
				    	'<textarea class="form-control" name="content" placeholder="Enter Content"></textarea>'+
				    '</div>'+
				  '</div>'+
			  
			'</div>';
				
			function buildoPreviewCv(formClientData) {
				// view cv in modal view container
				formClientData = typeof formClientData !== 'undefined' ? formClientData : null;

				for (var k in formClientData) {
			    	console.log(formClientData[k]);
			    }
                
			}
				function addSectionDetail(globalId) {
					var sectionAddData = ''+
						'<div class="tab-pane" id="'+globalId+'">'+
							'<label class="label--text heading">New Section</label>'+
							'<span style="margin-left: 20px; color:#9accea">'+
								'<a><i class="fa fa-pencil" data-toggle="modal" data-target="#myModal" title="Edit"></i>&nbsp;</a>'+
								'<a><i class="fa fa-text-height" title="Font-size"></i>&nbsp;</a>'+
								'<a><i class="fa fa-font" title="Color"></i></a>'+
								'<input type="color" class="fontSel" />'+
								'<a><i style="color:#ed7b7b;float:right" class="fa fa-times fa-2x" title="Delete"></i></a>'+
							'</span>'+
							'<hr/>'+
							'<textarea name="content" class="form-control" rows="6"></textarea>'+
							'<br />'+
							'<button class="btn btn-primary add--entry">Add Entry</button>'+
						'</div>';
					$('.tab-content').append(sectionAddData);
				}

				$('.add--new').click(function () {
					$('.btn-success.submit-form').before(newSection);
				});
				$(document).on('click', '.btn.add--entry', function () {
					
				});
				$('.add--section').click(function () {
					var newSection = '<li style="display:inline-block;" class="uis" href="#'+ globalSectionId +'" data-toggle="tab"><i style="color:#777;display:inline-block;" class="fa fa-arrows-v"></i> New Section</li>';
					$('#sortable').append(newSection);
					addSectionDetail(globalSectionId);
					$('li.uis').last().click();
					globalSectionId++;
				});

			});
			
		</script>

	</body>
</html>